{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/benjamin/Desktop/perso/ventejob/modules/auth/components/signin/index.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport { Field, Button } from \"@/commons/components\";\nimport useForm from \"@/commons/components/form/useForm\";\nimport { createUser } from \"services/auth\";\nimport { useMutation, queryCache } from \"react-query\";\nimport Router from \"next/router\";\nvar stateSchema = {\n  email: {\n    value: \"\",\n    error: \"\",\n    required: true\n  },\n  password: {\n    value: \"\",\n    error: \"\",\n    required: true\n  }\n};\n\nfunction Signin() {\n  _s();\n\n  var _useForm = useForm(stateSchema, onSubmitForm),\n      handleOnChange = _useForm.handleOnChange,\n      handleOnSubmit = _useForm.handleOnSubmit,\n      disable = _useForm.disable,\n      meta = _useForm.meta,\n      setMeta = _useForm.setMeta;\n\n  var onSignin = function onSignin(_ref) {\n    var email = _ref.email,\n        password = _ref.password;\n    return createUser.signin(email, password);\n  };\n\n  var _useMutation = useMutation(onSignin, {\n    onSuccess: function onSuccess() {\n      queryCache.refetchQueries(\"hassession\").then(function () {\n        return Router.push(\"/\");\n      });\n    },\n    onError: function onError(e) {\n      setMeta({\n        message: e.message\n      });\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      mutate = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      status = _useMutation2$.status,\n      data = _useMutation2$.data,\n      error = _useMutation2$.error;\n\n  function onSubmitForm(state) {\n    mutate({\n      email: state.email.value,\n      password: state.password.value\n    });\n  }\n\n  console.log(status);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 5\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }\n  }, \"Signin component\"), __jsx(\"form\", {\n    onSubmit: handleOnSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }\n  }, __jsx(Field, {\n    onChange: handleOnChange,\n    label: \"Email\",\n    type: \"text\",\n    name: \"email\",\n    placeholder: \"julie.martn@gmail.com\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  }), __jsx(Field, {\n    onChange: handleOnChange,\n    label: \"Mot de passe\",\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"+7 lettres\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    type: \"submit\",\n    onChange: handleOnChange,\n    size: \"large\",\n    kind: \"secondary\",\n    disabled: disable,\n    loading: status === \"loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, \"Submit\"), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, meta && meta.message)));\n}\n\n_s(Signin, \"oX4zhximJEQK7NdidxI6nV8Dc4c=\", false, function () {\n  return [useForm, useMutation];\n});\n\n_c = Signin;\nexport default Signin;\n\nvar _c;\n\n$RefreshReg$(_c, \"Signin\");","map":{"version":3,"sources":["/Users/benjamin/Desktop/perso/ventejob/modules/auth/components/signin/index.jsx"],"names":["React","Field","Button","useForm","createUser","useMutation","queryCache","Router","stateSchema","email","value","error","required","password","Signin","onSubmitForm","handleOnChange","handleOnSubmit","disable","meta","setMeta","onSignin","signin","onSuccess","refetchQueries","then","push","onError","e","message","mutate","status","data","state","console","log"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Field, Button } from \"@/commons/components\";\nimport useForm from \"@/commons/components/form/useForm\";\nimport { createUser } from \"services/auth\";\nimport { useMutation, queryCache } from \"react-query\";\nimport Router from \"next/router\";\n\nconst stateSchema = {\n  email: { value: \"\", error: \"\", required: true },\n  password: { value: \"\", error: \"\", required: true },\n};\n\nfunction Signin() {\n  const { handleOnChange, handleOnSubmit, disable, meta, setMeta } = useForm(\n    stateSchema,\n    onSubmitForm\n  );\n\n  const onSignin = ({ email, password }) => createUser.signin(email, password);\n\n  const [mutate, { status, data, error }] = useMutation(onSignin, {\n    onSuccess: () => {\n      queryCache.refetchQueries(\"hassession\").then(() => Router.push(\"/\"));\n    },\n    onError: (e) => {\n      setMeta({ message: e.message });\n    },\n  });\n\n  function onSubmitForm(state) {\n    mutate({ email: state.email.value, password: state.password.value });\n  }\n\n  console.log(status);\n\n  return (\n    <div>\n      <h2>Signin component</h2>\n      <form onSubmit={handleOnSubmit}>\n        <Field\n          onChange={handleOnChange}\n          label=\"Email\"\n          type=\"text\"\n          name=\"email\"\n          placeholder=\"julie.martn@gmail.com\"\n        />\n        <Field\n          onChange={handleOnChange}\n          label=\"Mot de passe\"\n          type=\"password\"\n          name=\"password\"\n          placeholder=\"+7 lettres\"\n        />\n        <Button\n          type=\"submit\"\n          onChange={handleOnChange}\n          size=\"large\"\n          kind=\"secondary\"\n          disabled={disable}\n          loading={status === \"loading\"}\n        >\n          Submit\n        </Button>\n        <p>{meta && meta.message}</p>\n      </form>\n    </div>\n  );\n}\n\nexport default Signin;\n"]},"metadata":{},"sourceType":"module"}