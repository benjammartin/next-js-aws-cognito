{"ast":null,"code":"var _jsxFileName = \"/Users/benjamin/Desktop/perso/ventejob/modules/auth/components/UserContext.jsx\";\nvar __jsx = React.createElement;\nimport React, { createContext, useContext } from \"react\";\nimport { useQuery, useMutation, queryCache } from \"react-query\";\nimport { createUser } from \"services/auth\";\nimport Router from \"next/router\";\nconst User = createContext(null);\n\nfunction AuthProvider({\n  children\n}) {\n  async function Logout() {\n    return await createUser.logout();\n  }\n\n  const [mutate] = useMutation(Logout, {\n    onSuccess: () => {\n      queryCache.refetchQueries(\"hassession\").then(() => Router.push(\"/auth/signin\"));\n    },\n    onError: e => {\n      console.log(e);\n    }\n  });\n\n  async function hasSession() {\n    return await createUser.hasSession();\n  }\n\n  const {\n    data: session\n  } = useQuery(\"hassession\", hasSession);\n  console.log(session);\n  return __jsx(User.Provider, {\n    value: [session, () => mutate()],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 5\n    }\n  }, children);\n}\n\nexport const useAuth = () => useContext(User);\nexport default AuthProvider;","map":{"version":3,"sources":["/Users/benjamin/Desktop/perso/ventejob/modules/auth/components/UserContext.jsx"],"names":["React","createContext","useContext","useQuery","useMutation","queryCache","createUser","Router","User","AuthProvider","children","Logout","logout","mutate","onSuccess","refetchQueries","then","push","onError","e","console","log","hasSession","data","session","useAuth"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,UAA/B,QAAiD,OAAjD;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,UAAhC,QAAkD,aAAlD;AACA,SAASC,UAAT,QAA2B,eAA3B;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,MAAMC,IAAI,GAAGP,aAAa,CAAC,IAAD,CAA1B;;AAEA,SAASQ,YAAT,CAAsB;AAAEC,EAAAA;AAAF,CAAtB,EAAoC;AAClC,iBAAeC,MAAf,GAAwB;AACtB,WAAO,MAAML,UAAU,CAACM,MAAX,EAAb;AACD;;AAED,QAAM,CAACC,MAAD,IAAWT,WAAW,CAACO,MAAD,EAAS;AACnCG,IAAAA,SAAS,EAAE,MAAM;AACfT,MAAAA,UAAU,CACPU,cADH,CACkB,YADlB,EAEGC,IAFH,CAEQ,MAAMT,MAAM,CAACU,IAAP,CAAY,cAAZ,CAFd;AAGD,KALkC;AAMnCC,IAAAA,OAAO,EAAGC,CAAD,IAAO;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD;AARkC,GAAT,CAA5B;;AAWA,iBAAeG,UAAf,GAA4B;AAC1B,WAAO,MAAMhB,UAAU,CAACgB,UAAX,EAAb;AACD;;AACD,QAAM;AAAEC,IAAAA,IAAI,EAAEC;AAAR,MAAoBrB,QAAQ,CAAC,YAAD,EAAemB,UAAf,CAAlC;AAEAF,EAAAA,OAAO,CAACC,GAAR,CAAYG,OAAZ;AAEA,SACE,MAAC,IAAD,CAAM,QAAN;AAAe,IAAA,KAAK,EAAE,CAACA,OAAD,EAAU,MAAMX,MAAM,EAAtB,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAkDH,QAAlD,CADF;AAGD;;AAED,OAAO,MAAMe,OAAO,GAAG,MAAMvB,UAAU,CAACM,IAAD,CAAhC;AACP,eAAeC,YAAf","sourcesContent":["import React, { createContext, useContext } from \"react\";\nimport { useQuery, useMutation, queryCache } from \"react-query\";\nimport { createUser } from \"services/auth\";\nimport Router from \"next/router\";\n\nconst User = createContext(null);\n\nfunction AuthProvider({ children }) {\n  async function Logout() {\n    return await createUser.logout();\n  }\n\n  const [mutate] = useMutation(Logout, {\n    onSuccess: () => {\n      queryCache\n        .refetchQueries(\"hassession\")\n        .then(() => Router.push(\"/auth/signin\"));\n    },\n    onError: (e) => {\n      console.log(e);\n    },\n  });\n\n  async function hasSession() {\n    return await createUser.hasSession();\n  }\n  const { data: session } = useQuery(\"hassession\", hasSession);\n\n  console.log(session);\n\n  return (\n    <User.Provider value={[session, () => mutate()]}>{children}</User.Provider>\n  );\n}\n\nexport const useAuth = () => useContext(User);\nexport default AuthProvider;\n"]},"metadata":{},"sourceType":"module"}